import{f as G,r as u,P as L,c as f,a as o,K as l,I as p,F as D,a0 as S,u as b,C as K,D as X,$ as r,o as g,G as z,M as d,H as T}from"./index-959d996c.js";import{$ as Y,a as O,q as R}from"./axios-4ed5dc48.js";function W(V,w){return new Promise(function(_,x){Y.ajax({url:"https://apis.map.qq.com/ws/geocoder/v1/?location="+w+","+V+"&key=J4PBZ-YNE6K-YTSJR-AGXXU-ITI6H-Y4FJV&get_poi=1&output=jsonp&callback=?",type:"get",dataType:"jsonp",success:function(i){i&&i.result&&i.result.address_component?_(i.result.address_component):_({})}})})}const Z={class:"near_box"},Q={id:"first_row"},nn={class:"first_row_col2"},en={class:"noticebar"},tn={class:"wanrn_detaill"},an={class:"classification"},on={class:"no_data"},pn={__name:"near",setup(V){G(()=>{H(),k("hydrographicStation",i.value)});const w=["冰雹橙色.png","冰雹红色.png","冰雹黄色.png","台风橙色.png","台风红色.png","台风蓝色.png","台风黄色.png","大雾橙色.png","大雾红色.png","大雾蓝色.png","大雾黄色.png","大风橙色.png","大风红色.png","大风蓝色.png","大风黄色.png","干旱橙色.png","干旱红色.png","干旱蓝色.png","干旱黄色.png","暴雨橙色.png","暴雨红色.png","暴雨蓝色.png","暴雨黄色.png","暴雪橙色.png","暴雪红色.png","暴雪蓝色.png","暴雪黄色.png","沙尘暴橙色.png","沙尘暴红色.png","沙尘暴蓝色.png","沙尘暴黄色.png","海上大雾橙色.png","海上大风橙色.png","海上大风蓝色.png","海上大风黄色.png","雷暴大雨红色.png","雷暴大风橙色.png","雷暴大风蓝色.png","雷暴大风黄色.png","雷电橙色.png","雷电红色.png","雷电蓝色.png","雷电黄色.png","雷雨大风橙色.png","雷雨大风红色.png","雷雨大风蓝色.png","雷雨大风黄色.png","高温橙色.png","高温红色.png","高温蓝色.png","高温黄色.png"],_=u(0),x=[{text:"东莞市",value:0},{text:"河源市",value:1},{text:"惠州市",value:2},{text:"深圳市",value:3},{text:"广州市",value:4},{text:"韶关市",value:5},{text:"梅州市",value:6}];let i=u("东莞市");const A=n=>{let e=x.find((s,a)=>a==n);i.value=e.text,k("hydrographicStation",i.value),v.length>=0&&j(0)},F=n=>{const e=new Date(n),s=e.getFullYear(),a=e.getMonth()+1,m=e.getDate(),h=e.getHours(),y=e.getMinutes();return`${s}年${a}月${m}日${h}时${y}分`};let c=L([]);const H=()=>{Y.ajax({url:"http://open.gd121.cn/share/data/getYJ.do?type=json&key=0b9fdc1c7526ae60e6ba59f82453aa3a&logType=warn",method:"get",success:function(n){c.push(n.东莞[0]),c.push(n.河源[0]),c.push(n.惠州[0]),c.push(n.深圳[0]),c.push(n.广州[0]),c.push(n.韶关[0]),c.forEach(e=>{e.publishtime=F(e.publishtime)}),c.forEach(e=>{const s=w.find(a=>a.includes(e.warn));s&&(e.pic=`./warning/${s}`)}),console.log("warningCityArr",c)}})},J=[{image:"./classIcon/stations.png",text:"水文站",type:"hydrographicStation"},{image:"./classIcon/aqueduct.png",text:"人工渠",type:"artificialCanal"},{image:"./classIcon/river.png",text:"河流",type:"river"},{image:"./classIcon/lake.png",text:"湖泊",type:"lake"},{image:"./classIcon/disaster.png",text:"灾害",type:"disaster"},{image:"./classIcon/humanact.png",text:"人文活动",type:"humanisticActivity"},{image:"./classIcon/cityview.png",text:"城市景点",type:""},{image:"./classIcon/heritage.png",text:"文化遗产",type:"culturalHeritage"},{image:"./classIcon/museum.png",text:"博物馆",type:"museum"},{image:"./classIcon/more.png",text:"更多",type:""}];let v=L([]);const $=u(null),j=(n,e)=>{$.value=e,v.length=0,k(n.type,i.value)},C=u(null),I=u(null),E=u(null),M=u(null),N=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(n=>{console.log("position",n),C.value=n.coords.latitude,I.value=n.coords.longitude;const e=C.value,s=I.value;E.value=null,W(s,e).then(a=>{a.street&&(M.value=a)})},n=>{n.value=n.message,C.value=null,I.value=null}):E.value="浏览器不支持地理位置获取"},k=(n,e)=>{console.log("city",e);const s={type:n,localtion:{district:"",nation:"中国",province:"广东省",city:e,street:"",street_number:""}};O.post("https://eslab.dgut.edu.cn/getDongjiangTypeList",R.stringify(s)).then(a=>{console.log("分类数据",a),a.data.data.forEach(m=>{v.push(m)})}).catch(a=>{console.error(a)})};return(n,e)=>{const s=r("van-dropdown-item"),a=r("van-dropdown-menu"),m=r("van-search"),h=r("van-image"),y=r("van-col"),q=r("van-row"),P=r("van-swipe-item"),U=r("van-swipe");return g(),f("div",Z,[o("div",Q,[o("div",{class:"first_row_col1",onClick:N},[l(a,null,{default:p(()=>[l(s,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=t=>_.value=t),options:x,onChange:A},null,8,["modelValue"])]),_:1})]),o("div",nn,[l(m,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value=t),placeholder:"搜索附近",onSearch:n.onSearch,onCancel:n.onCancel},null,8,["modelValue","onSearch","onCancel"])])]),o("div",null,[l(q,null,{default:p(()=>[(g(),f(D,null,S(J,(t,B)=>l(y,{id:"each_detail",key:t.text,span:4.8},{default:p(()=>[l(h,{src:t.image,onClick:sn=>j(t,B),fit:"contain",class:z({selected:B==$.value})},null,8,["src","onClick","class"]),o("p",null,d(t.text),1)]),_:2},1032,["span"])),64))]),_:1})]),o("div",en,[l(U,{class:"wanring-swipe",autoplay:3e3,"indicator-color":"gray"},{default:p(()=>[(g(!0),f(D,null,S(b(c),t=>(g(),T(P,{key:t.city},{default:p(()=>[l(h,{class:"swiperImage",src:t.pic,fit:"contain"},null,8,["src"]),o("div",tn,[o("div",null,d(t.publishtime),1),o("div",null,d(t.city),1),o("div",null,d(t.warn),1)])]),_:2},1024))),128))]),_:1})]),o("div",an,[(g(!0),f(D,null,S(b(v),t=>(g(),T(q,{key:t.text,class:"each_classify",justify:"center"},{default:p(()=>[l(y,{span:"10"},{default:p(()=>[l(h,{class:"swiperImage",src:"./no-image.png",fit:"cover"})]),_:1}),l(y,{class:"each_classify_detail",span:"14"},{default:p(()=>[o("div",null,d(t.name),1),o("div",null,d(t.intro),1)]),_:2},1024)]),_:2},1024))),128)),K(o("div",on,"暂无数据",512),[[X,b(v).length==0]])])])}}};export{pn as default};
