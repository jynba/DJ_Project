import{f as G,r,P as E,c as f,a as s,K as o,I as i,F as C,a0 as k,u as y,C as L,D as T,$ as u,o as d,G as K,M as g,H as Y}from"./index-5e484344.js";import{$ as A,a as X,q as z}from"./jquery-b71e65ea.js";function O(D,m){return new Promise(function(h,V){A.ajax({url:"https://apis.map.qq.com/ws/geocoder/v1/?location="+m+","+D+"&key=J4PBZ-YNE6K-YTSJR-AGXXU-ITI6H-Y4FJV&get_poi=1&output=jsonp&callback=?",type:"get",dataType:"jsonp",success:function(n){n&&n.result&&n.result.address_component?h(n.result.address_component):h({})}})})}const R={class:"near_box"},Z={id:"first_row"},Q={class:"first_row_col2"},W={class:"noticebar"},ee={class:"wanrn_detaill"},te={class:"classification"},ae={class:"no_data"},le={__name:"near",setup(D){G(()=>{$(),F(),j(0),P()});const m=r(1),h=[{text:"东莞",value:1},{text:"河源",value:2},{text:"惠州",value:3},{text:"深圳",value:4},{text:"广州",value:5},{text:"韶关",value:6}],V=e=>{const t=new Date(e),c=t.getFullYear(),l=t.getMonth()+1,I=t.getDate(),_=t.getHours(),v=t.getMinutes();return`${c}年${l}月${I}日${_}时${v}分`};let n=E([]);const F=()=>{A.ajax({url:"http://open.gd121.cn/share/data/getYJ.do?type=json&key=0b9fdc1c7526ae60e6ba59f82453aa3a&logType=warn",method:"get",success:function(e){console.log(e,"数据判断"),n.push(e.东莞[0]),n.push(e.河源[0]),n.push(e.惠州[0]),n.push(e.深圳[0]),n.push(e.广州[0]),n.push(e.韶关[0]),n.forEach(t=>{t.publishtime=V(t.publishtime)}),console.log("warningCityArr",n)}})},J=[{image:"./classIcon/stations.png",text:"水文站"},{image:"./classIcon/aqueduct.png",text:"人工渠"},{image:"./classIcon/river.png",text:"河流"},{image:"./classIcon/lake.png",text:"湖泊"},{image:"./classIcon/disaster.png",text:"灾害"},{image:"./classIcon/humanact.png",text:"人文活动"},{image:"./classIcon/cityview.png",text:"城市景点"},{image:"./classIcon/heritage.png",text:"文化遗产"},{image:"./classIcon/museum.png",text:"博物馆"},{image:"./classIcon/more.png",text:"更多"}],M=[{image:"./testdetail.png",text:"广东省河源市和平县优胜镇，辖区面积117.31平方千米",city:"优胜镇"},{image:"./testdetail.png",text:"广东省河源市和平县上陵镇，辖区面积117.31平方千米",city:"上陵镇"},{image:"./testdetail.png",text:"广东省河源市和平县合水镇，辖区面积147.31平方千米",city:"合水镇"},{image:"./testdetail.png",text:"广东省河源市和平县下车镇，辖区面积107.31平方千米",city:"下车镇"},{image:"./testdetail.png",text:"广东省河源市和平县长安镇，辖区面积116.31平方千米）",city:"长安镇"}];let p=E([]);const b=r(null),j=e=>{b.value=e;const t=M.filter((c,l)=>l===e);p.length=0,t.forEach(c=>{p.push(c)})},w=r(null),x=r(null),S=r(null),N=r(null),$=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{w.value=e.coords.latitude,x.value=e.coords.longitude;const t=w.value,c=x.value;S.value=null,O(c,t).then(l=>{console.log(l),l.street&&(console.log(),console.log("location.street",l.street),N.value=l.street)})},e=>{e.value=e.message,w.value=null,x.value=null}):S.value="浏览器不支持地理位置获取"},P=()=>{const e={type:"lake"};X.post("https://eslab.dgut.edu.cn/getDongjiangTypeList",z.stringify(e)).then(t=>{console.log("分类数据",t)}).catch(t=>{console.error(t)})};return(e,t)=>{const c=u("van-dropdown-item"),l=u("van-dropdown-menu"),I=u("van-search"),_=u("van-image"),v=u("van-col"),q=u("van-row"),H=u("van-swipe-item"),U=u("van-swipe");return d(),f("div",R,[s("div",Z,[s("div",{class:"first_row_col1",onClick:$},[o(l,null,{default:i(()=>[o(c,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=a=>m.value=a),options:h},null,8,["modelValue"])]),_:1})]),s("div",Q,[o(I,{modelValue:e.value,"onUpdate:modelValue":t[1]||(t[1]=a=>e.value=a),placeholder:"搜索附近",onSearch:e.onSearch,onCancel:e.onCancel},null,8,["modelValue","onSearch","onCancel"])])]),s("div",null,[o(q,null,{default:i(()=>[(d(),f(C,null,k(J,(a,B)=>o(v,{id:"each_detail",key:a.text,span:4.8},{default:i(()=>[o(_,{src:a.image,onClick:ne=>j(B),fit:"contain",class:K({selected:B==b.value})},null,8,["src","onClick","class"]),s("p",null,g(a.text),1)]),_:2},1032,["span"])),64))]),_:1})]),s("div",W,[o(U,{class:"wanring-swipe",autoplay:3e3,"indicator-color":"gray"},{default:i(()=>[(d(!0),f(C,null,k(y(n),a=>(d(),Y(H,{key:a.city},{default:i(()=>[o(_,{class:"swiperImage",src:"./wind/wind-yellow.png",fit:"contain"}),s("div",ee,[s("div",null,g(a.publishtime),1),s("div",null,g(a.city),1),s("div",null,g(a.warn),1)])]),_:2},1024))),128))]),_:1})]),s("div",te,[(d(!0),f(C,null,k(y(p),a=>L((d(),Y(q,{key:a.text,class:"each_classify",justify:"center"},{default:i(()=>[o(v,{span:"10"},{default:i(()=>[o(_,{class:"swiperImage",src:a.image,fit:"cover"},null,8,["src"])]),_:2},1024),o(v,{class:"each_classify_detail",span:"14"},{default:i(()=>[s("div",null,g(a.city),1),s("div",null,g(a.text),1)]),_:2},1024)]),_:2},1024)),[[T,y(p).length>=0]])),128)),L(s("div",ae,"暂无数据",512),[[T,y(p).length==0]])])])}}};export{le as default};
