import{f as Y,r,P as j,$ as i,o as g,c as y,a as o,K as l,I as p,F as C,a0 as I,u as k,C as z,D as G,G as J,M as u,H as B}from"./index-bb41ea54.js";import{$ as K,a as O,q as W,g as Q}from"./displayArea-9f4acb4a.js";const R={class:"near_box"},X={id:"first_row"},Z={class:"first_row_col2"},nn={class:"noticebar"},en={class:"wanrn_detaill"},tn={class:"classification"},an={class:"no_data"},pn={__name:"near",setup(on){Y(()=>{F(),x("hydrographicStation",h.value)});const M=["冰雹橙色.png","冰雹红色.png","冰雹黄色.png","台风橙色.png","台风红色.png","台风蓝色.png","台风黄色.png","大雾橙色.png","大雾红色.png","大雾蓝色.png","大雾黄色.png","大风橙色.png","大风红色.png","大风蓝色.png","大风黄色.png","干旱橙色.png","干旱红色.png","干旱蓝色.png","干旱黄色.png","暴雨橙色.png","暴雨红色.png","暴雨蓝色.png","暴雨黄色.png","暴雪橙色.png","暴雪红色.png","暴雪蓝色.png","暴雪黄色.png","沙尘暴橙色.png","沙尘暴红色.png","沙尘暴蓝色.png","沙尘暴黄色.png","海上大雾橙色.png","海上大风橙色.png","海上大风蓝色.png","海上大风黄色.png","雷暴大雨红色.png","雷暴大风橙色.png","雷暴大风蓝色.png","雷暴大风黄色.png","雷电橙色.png","雷电红色.png","雷电蓝色.png","雷电黄色.png","雷雨大风橙色.png","雷雨大风红色.png","雷雨大风蓝色.png","雷雨大风黄色.png","高温橙色.png","高温红色.png","高温蓝色.png","高温黄色.png"],D=r(1),S=[{text:"东莞市",value:0},{text:"河源市",value:1},{text:"惠州市",value:2},{text:"深圳市",value:3},{text:"广州市",value:4},{text:"韶关市",value:5},{text:"梅州市",value:6}];let h=r("东莞市");const q=n=>{console.log("val",n);let e=S.find((s,a)=>a==n);h.value=e.text,x("hydrographicStation",h.value),d.length>=0&&V(0)},A=n=>{const e=new Date(n),s=e.getFullYear(),a=e.getMonth()+1,_=e.getDate(),v=e.getHours(),m=e.getMinutes();return`${s}年${a}月${_}日${v}时${m}分`};let c=j([]);const F=()=>{K.ajax({url:"http://open.gd121.cn/share/data/getYJ.do?type=json&key=0b9fdc1c7526ae60e6ba59f82453aa3a&logType=warn",method:"get",success:function(n){c.push(n.东莞[0]),c.push(n.河源[0]),c.push(n.惠州[0]),c.push(n.深圳[0]),c.push(n.广州[0]),c.push(n.韶关[0]),c.forEach(e=>{e.publishtime=A(e.publishtime)}),c.forEach(e=>{const s=M.find(a=>a.includes(e.warn));s&&(e.pic=`./warning/${s}`)}),console.log("warningCityArr",c)}})},H=[{image:"./classIcon/stations.png",text:"水文站",type:"hydrographicStation"},{image:"./classIcon/aqueduct.png",text:"人工渠",type:"artificialCanal"},{image:"./classIcon/river.png",text:"河流",type:"river"},{image:"./classIcon/lake.png",text:"湖泊",type:"lake"},{image:"./classIcon/disaster.png",text:"灾害",type:"disaster"},{image:"./classIcon/humanact.png",text:"人文活动",type:"humanisticActivity"},{image:"./classIcon/cityview.png",text:"城市景点",type:""},{image:"./classIcon/heritage.png",text:"文化遗产",type:"culturalHeritage"},{image:"./classIcon/museum.png",text:"博物馆",type:"museum"},{image:"./classIcon/more.png",text:"更多",type:""}];let d=j([]);const b=r(null),V=(n,e)=>{b.value=e,d.length=0,x(n.type,h.value)},f=r(null),w=r(null),$=r(null),N=r(null),P=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(n=>{console.log("position",n),f.value=n.coords.latitude,w.value=n.coords.longitude;const e=f.value,s=w.value;$.value=null,Q(s,e).then(a=>{a.street&&(N.value=a)})},n=>{n.value=n.message,f.value=null,w.value=null}):$.value="浏览器不支持地理位置获取"},x=(n,e)=>{console.log("city",e);const s={type:n,localtion:{district:"",nation:"中国",province:"广东省",city:e,street:"",street_number:""}};O.post("https://eslab.dgut.edu.cn/getDongjiangTypeList",W.stringify(s)).then(a=>{console.log("分类数据",a),a.data.data.forEach(_=>{d.push(_)})}).catch(a=>{console.error(a)})};return(n,e)=>{const s=i("van-dropdown-item"),a=i("van-dropdown-menu"),_=i("van-search"),v=i("van-image"),m=i("van-col"),E=i("van-row"),T=i("van-swipe-item"),U=i("van-swipe");return g(),y("div",R,[o("div",X,[o("div",{class:"first_row_col1",onClick:P},[l(a,null,{default:p(()=>[l(s,{modelValue:D.value,"onUpdate:modelValue":e[0]||(e[0]=t=>D.value=t),options:S,onChange:q},null,8,["modelValue"])]),_:1})]),o("div",Z,[l(_,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value=t),placeholder:"搜索附近",onSearch:n.onSearch,onCancel:n.onCancel},null,8,["modelValue","onSearch","onCancel"])])]),o("div",null,[l(E,null,{default:p(()=>[(g(),y(C,null,I(H,(t,L)=>l(m,{id:"each_detail",key:t.text,span:4.8},{default:p(()=>[l(v,{src:t.image,onClick:sn=>V(t,L),fit:"contain",class:J({selected:L==b.value})},null,8,["src","onClick","class"]),o("p",null,u(t.text),1)]),_:2},1024)),64))]),_:1})]),o("div",nn,[l(U,{class:"wanring-swipe",autoplay:3e3,"indicator-color":"gray"},{default:p(()=>[(g(!0),y(C,null,I(k(c),t=>(g(),B(T,{key:t.city},{default:p(()=>[l(v,{class:"swiperImage",src:t.pic,fit:"contain"},null,8,["src"]),o("div",en,[o("div",null,u(t.publishtime),1),o("div",null,u(t.city),1),o("div",null,u(t.warn),1)])]),_:2},1024))),128))]),_:1})]),o("div",tn,[(g(!0),y(C,null,I(k(d),t=>(g(),B(E,{key:t.text,class:"each_classify",justify:"center"},{default:p(()=>[l(m,{span:"10"},{default:p(()=>[l(v,{class:"swiperImage",src:"./no-image.png",fit:"cover"})]),_:1}),l(m,{class:"each_classify_detail",span:"14"},{default:p(()=>[o("div",null,u(t.name),1),o("div",null,u(t.intro),1)]),_:2},1024)]),_:2},1024))),128)),z(o("div",an,"暂无数据",512),[[G,k(d).length==0]])])])}}};export{pn as default};
