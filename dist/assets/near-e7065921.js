import{t as T,r as u,R as q,S as i,o as d,c as y,a as n,H as o,x as r,F as C,U as I,u as k,y as Y,E as J,z as O,D as p,v as F}from"./index-6a155e43.js";import{$ as P,g as R,a as G,q as K}from"./displayArea-3420d60b.js";const Q={class:"near_box"},W={id:"first_row"},X={class:"first_row_col2"},Z={class:"noticebar"},ee={class:"wanrn_detaill"},te={class:"classification"},ae={class:"no_data"},ce={__name:"near",setup(ne){T(()=>{E(),N(),x("hydrographicStation",h.value)});const D=u(1),S=[{text:"东莞市",value:1},{text:"河源市",value:2},{text:"惠州市",value:3},{text:"深圳市",value:4},{text:"广州市",value:5},{text:"韶关市",value:6}];let h=u("东莞市");const H=e=>{h.value=S.find((t,l)=>l==e),x("hydrographicStation",h.value),g.length>=0&&(console.log("d"),V(0))},M=e=>{const t=new Date(e),l=t.getFullYear(),s=t.getMonth()+1,_=t.getDate(),v=t.getHours(),m=t.getMinutes();return`${l}年${s}月${_}日${v}时${m}分`};let c=q([]);const N=()=>{P.ajax({url:"http://open.gd121.cn/share/data/getYJ.do?type=json&key=0b9fdc1c7526ae60e6ba59f82453aa3a&logType=warn",method:"get",success:function(e){c.push(e.东莞[0]),c.push(e.河源[0]),c.push(e.惠州[0]),c.push(e.深圳[0]),c.push(e.广州[0]),c.push(e.韶关[0]),c.forEach(t=>{t.publishtime=M(t.publishtime)})}})},U=[{image:"./classIcon/stations.png",text:"水文站",type:"hydrographicStation"},{image:"./classIcon/aqueduct.png",text:"人工渠",type:"artificialCanal"},{image:"./classIcon/river.png",text:"河流",type:"river"},{image:"./classIcon/lake.png",text:"湖泊",type:"lake"},{image:"./classIcon/disaster.png",text:"灾害",type:""},{image:"./classIcon/humanact.png",text:"人文活动",type:"humanisticActivity"},{image:"./classIcon/cityview.png",text:"城市景点",type:""},{image:"./classIcon/heritage.png",text:"文化遗产",type:"culturalHeritage"},{image:"./classIcon/museum.png",text:"博物馆",type:"museum"},{image:"./classIcon/more.png",text:"更多",type:""}];let g=q([]);const b=u(null),V=(e,t)=>{b.value=t,g.length=0,x(e.type)},f=u(null),w=u(null),$=u(null),j=u(null),E=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{f.value=e.coords.latitude,w.value=e.coords.longitude;const t=f.value,l=w.value;$.value=null,R(l,t).then(s=>{s.street&&(j.value=s)})},e=>{e.value=e.message,f.value=null,w.value=null}):$.value="浏览器不支持地理位置获取"},x=(e,t)=>{j.value;const l={type:e,obj:{district:"",nation:"中国",province:"广东省",city:h.value,street:"",street_number:""}};G.post("https://eslab.dgut.edu.cn/getDongjiangTypeList",K.stringify(l)).then(s=>{s.data.data.forEach(_=>{g.push(_)})}).catch(s=>{console.error(s)})};return(e,t)=>{const l=i("van-dropdown-item"),s=i("van-dropdown-menu"),_=i("van-search"),v=i("van-image"),m=i("van-col"),L=i("van-row"),z=i("van-swipe-item"),A=i("van-swipe");return d(),y("div",Q,[n("div",W,[n("div",{class:"first_row_col1",onClick:E},[o(s,null,{default:r(()=>[o(l,{modelValue:D.value,"onUpdate:modelValue":t[0]||(t[0]=a=>D.value=a),options:S,onChange:H},null,8,["modelValue"])]),_:1})]),n("div",X,[o(_,{modelValue:e.value,"onUpdate:modelValue":t[1]||(t[1]=a=>e.value=a),placeholder:"搜索附近",onSearch:e.onSearch,onCancel:e.onCancel},null,8,["modelValue","onSearch","onCancel"])])]),n("div",null,[o(L,null,{default:r(()=>[(d(),y(C,null,I(U,(a,B)=>o(m,{id:"each_detail",key:a.text,span:4.8},{default:r(()=>[o(v,{src:a.image,onClick:oe=>V(a,B),fit:"contain",class:O({selected:B==b.value})},null,8,["src","onClick","class"]),n("p",null,p(a.text),1)]),_:2},1024)),64))]),_:1})]),n("div",Z,[o(A,{class:"wanring-swipe",autoplay:3e3,"indicator-color":"gray"},{default:r(()=>[(d(!0),y(C,null,I(k(c),a=>(d(),F(z,{key:a.city},{default:r(()=>[o(v,{class:"swiperImage",src:"./wind/wind-yellow.png",fit:"contain"}),n("div",ee,[n("div",null,p(a.publishtime),1),n("div",null,p(a.city),1),n("div",null,p(a.warn),1)])]),_:2},1024))),128))]),_:1})]),n("div",te,[(d(!0),y(C,null,I(k(g),a=>(d(),F(L,{key:a.text,class:"each_classify",justify:"center"},{default:r(()=>[o(m,{span:"10"},{default:r(()=>[o(v,{class:"swiperImage",src:"./no-image.png",fit:"cover"})]),_:1}),o(m,{class:"each_classify_detail",span:"14"},{default:r(()=>[n("div",null,p(a.name),1),n("div",null,p(a.intro),1)]),_:2},1024)]),_:2},1024))),128)),Y(n("div",ae,"暂无数据",512),[[J,k(g).length==0]])])])}}};export{ce as default};
